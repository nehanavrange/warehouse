<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org/">
<head>
<meta charset="ISO-8859-1">
<title>register</title>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

</head>
<body>
	<div class="container">

		<div class="card">
			<div class="card-header bg-primary text-white text-center">
				<h3>WhUserType Register Page</h3>
			</div>
			<div class="card-body">
				<form th:action="@{/whusertype/save }" method="post"
					th:object="${whUserType}" id="whUserTypeForm">


					<!-- Row-1 -->
					<div class="row">
						<div class="col-4">
							<label for="userType">User Type</label>
						</div>
						<div class="col-4">
							<input type="radio" th:field="*{userType}" value="Vendor" />Vendor
							<input type="radio" th:field="*{userType}" value="Customer" />Customer

						</div>
						<div class="col-4">
							<span id="userTypeError"></span>
						</div>
					</div>

					<!-- Row-2 -->
					<div class="row">
						<div class="col-4">
							<label for="userCode">User Code</label>
						</div>
						<div class="col-4">
							<input type="text" th:field="*{userCode}" class="form-control" />
						</div>
						<div class="col-4">
							<span id="userCodeError"></span>
						</div>
					</div>

					<!-- Row-3 -->

					<div class="row">
						<div class="col-4">
							<label for="userFor">User For</label>
						</div>

						<div class="col-4">
							<input type="text" th:field="*{userFor}" class="form-control"
								readonly="readonly" />
						</div>

						<div class="col-4">
							<span id="userForError"></span>
						</div>
					</div>

					<!-- Row-4 -->
					<div class="row">
						<div class="col-4">
							<label for="userMail">User Mail</label>
						</div>

						<div class="col-4">
							<input type="text" th:field="*{userMail}" class="form-control" />
						</div>

						<div class="col-4">
							<span id="userMailError"></span>
						</div>
					</div>

					<!-- Row-5 -->
					<div class="row">
						<div class="col-4">
							<label for="userContact">User Contact</label>

						</div>

						<div class="col-4">
							<input type="text" th:field="*{userContact}" class="form-control" />
						</div>

						<div class="col-4">
							<span id="userContactError"></span>
						</div>
					</div>

					<!-- Row-6 -->

					<div class="row">
						<div class="col-4">
							<label for="userIdType">User Id Type</label>
						</div>
						<div class="col-4">
							<select th:field="*{userIdType}" class="form-control">
								<option value="">-select-</option>
								<option value="PAN CARD">PAN CARD</option>
								<option value="AADHAR CARD">AADHAR CARD</option>
								<option value="VOTER ID CARD">VOTER ID CARD</option>
								<option value="OTHER">OTHER</option>

							</select>
						</div>
						<div class="col-4">
							<span id="userIdTypeError"></span>
						</div>
					</div>

					<!-- Row-7 -->
					<div class="row">
						<div class="col-4">
							<label for="ifOther">If Other</label>
						</div>

						<div class="col-4">
							<input type="text" th:field="*{ifOther}" class="form-control"
								readonly="readonly" />
						</div>

						<div class="col-4">
							<span id="ifOtherError"></span>
						</div>
					</div>

					<!-- Row-8 -->
					<div class="row">
						<div class="col-4">
							<label for="idNumber">Id Number</label>
						</div>

						<div class="col-4">
							<input type="text" th:field="*{idNumber}" class="form-control" />
						</div>

						<div class="col-4">
							<span id="idNumberError"></span>
						</div>
					</div>


					<input type="submit" class="btn btn-success" value="Add WhUserType" />


				</form>
			</div>
			<!-- Body End -->

			<div th:if="${message!=null}">
				<div class="card-footer bg-info text-white text-center">
					<b><span th:text="${message}"></span></b>
				</div>
			</div>
			<!-- Footer End -->

		</div>
		<!-- Card End -->
	</div>
	<!-- Container End -->

	<script type="text/javascript">
        $(document).ready(function(){
            // $("#userTypeError").hide();
            // $("#userCodeError").hide();
            // $("#userForError").hide();
		     $("#userMailError").hide();
		    // $("#userContactError").hide();
            // $("#userIdTypeError").hide();
            // $("#ifOtherError").hide();
            // $("#idNumberError").hide();

            
            $("#userMail").keyup(function(){
            validate_userMail();	
            });
           
            function validate_userMail(){
            	var val=$("#userMail").val();
            	var exp=/^[A-Za-z0-9\.\-]+\@[a-z]+\.[a-z\.]{2,10}$/;
            	if(val==''){
            		$("#userMailError").html("Enter <b>User Mail</b>");
            		$("#userMailError").css("color","red");
            		$("#userMailError").show();
            		userMailError=false;
            	}
            	else if(!exp.test(val)){
            		$("#userMailError").html("Enter <b>Valid Mail Id</b>");
            		$("#userMailError").css("color","red");
            		$("#userMailError").show();
            		userMailError=false;
            	}
            	else{
            		//Ajax start communicate with database, checking duplicates 
    				$.ajax({
    				
    					url : 'mailcheck',
    					data: {"mail":val},
    					success:function(restext){
    					if(restext!=""){
    						$("#userMailError").show();
    						$("#userMailError").html(restext);
    						$("#userMailError").css("color","red");
    						userMailError=false;
    					}
    					else{

    						$("#userMailError").hide();
    	            		userMailError=true;
    					}
    			
    				} //success:function() end
            		
    				});
            	}
            	return userMailError;
            }
            
            
            
            
            
            
             //---extra validations work --//
            //--Auto Fill for User For---
            $('input[type="radio"][name="userType"]').change(function () {
                autoFillUserFor();
            });

            function autoFillUserFor() {
                var val = $('input[type="radio"][name="userType"]:checked').val();
                if (val == 'Vendor') {
                    $("#userFor").val('Purchase');
                } else if (val == 'Customer') {
                    $("#userFor").val('Sale');
                }
            }
            
            //ifOther Text Input
            $("#userIdType").change(function(){
                var val=$("#userIdType").val();
                
                if(val=='OTHER'){
                    $("#ifOther").removeAttr("readOnly");
                }
                else{
                    $("#ifOther").attr("readOnly","true");
                    $("#ifOther").val("");
                }


            });
            
            //on submit
             $("#whUserTypeForm").submit(function(){
            	 validate_userMail();
            	 
            	 if(userMailError)
            		 {
            		 return true;
            		 }
            	 else{
            		 return false;
            	 }
            	 
             });
            

        });


</script>

</body>
</html>